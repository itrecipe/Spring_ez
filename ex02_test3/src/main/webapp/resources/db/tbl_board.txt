create sequence seq_board;

create table tbl_board (
bno number(10,0),
title varchar2(200) not null,
content varchar2(2000) not null,
writer varchar2(50) not null,
regdate date default sysdate, 
updatedate date default sysdate
);

alter table tbl_board add constraint pk_board primary key(bno);
commit;

insert into tbl_board (bno, title, content, writer) 
values(seq_board.nextval, '테스트 제목','테스트 내용','user00');

commit;

CREATE TABLE TBL_REPLY(
rno number(10,0) not null,  --pk
bno number(10,0) not null, --FK
reply varchar2(1000) not null,
replyer varchar2(50) not null,
replyDate date default sysdate,
updatedate date default sysdate
);

create sequence seq_reply nocache;

alter table tbl_reply add constraint pk_reply primary key (rno);

alter table tbl_reply add constraint fk_reply_board foreign key (bno) references tbl_board (bno);

commit;

Create index idx_reply on tbl_reply (bno desc,rno asc) ;

--transaction
Create table tbl_sample1(col1 varchar2(500));

Create table tbl_sample2(col2 varchar2(50)); ---test를 위해 일부러 적게함

alter table tbl_board add (replycnt number default 0);

update tbl_board set replycnt = (select count(rno) from tbl_reply where tbl_reply.bno = tbl_board.bno);

--이미지 로딩 테이블
create table tbl_attach(
uuid varchar2(100) not null,
uploadPath varchar2(200) not null,
fileName varchar2(100) not null,
filetype char(1) default 'I',
bno number(10,0)
);

alter table tbl_attach add constraint pk_attach primary key (uuid);

alter table tbl_attach add constraint fk_board_attach foreign key (bno) references tbl_board(bno);

commit;

-- 쇼핑몰용
create table product {
code number(5),
name varchar2(100),
price number(8),
picturl varchar2(100),
description varchar2(1000),
primary key(code)
);

create sequence product_seq nocache;

insert into product values(product_seq.nextval,'개념을 잡아주는 데이터베이스',27000,
'db.jpg','초보자를 위한 데이터 베이스 책');
insert into product values(product_seq.nextval,'개념을 잡아주는 JSP',27000,
'db.jpg','초보자를 위한 JSP 책');
insert into product values(product_seq.nextval,'개념을 잡아주는 JAVA',27000,
'db.jpg','초보자를 위한 JAVA 책');
insert into product values(product_seq.nextval,'개념을 잡아주는 C++',27000,
'db.jpg','초보자를 위한 C++ 책');

--시큐리티용 회원테이블
create table tbl_member(
userid varchar2(50) not null primary key,
userpw varchar2(100) not null,
username varchar2(100) not null,
regdate date default sysdate, 
updatedate date default sysdate,
enabled char(1) default '1');

--권한 테이블
create table tbl_member_auth (
 userid varchar2(50) not null,
 auth varchar2(50) not null,
 constraint fk_member_auth foreign key(userid) references tbl_member(userid)
);

--remember-me 관련 테이블(스프링 지정 규격)      
create table persistent_logins (
username varchar2(64) not null, 
series varchar2(64) primary key, 
token varchar2(64) not null, 
last_used timestamp not null);

